# Process 이해 및 스케줄러

<br/>

## 프로세스의 개념
현재 시스템에서 실행 중인 프로그램

### 프로세스의 특징
부팅할 때 스케줄러가 실행한 프로세스인 systemd와 kthreadd 프로세스를 제외하면 모든 프로세스는 부모 프로세스를 가지고 있다.  
각 프로세스는 고유한 번호를 갖고 있는데 이것이 PID다. systemd의 PID는 1, kthreadd의 PID는 2이다.

### 프로세스의 종류
- 데몬 프로세스: 특정 서비스 제공을 위해 존재. Linux kernel에 의해 실행된다.  
- 고아 프로세스: 부모 프로세스가 먼저 종료된 프로세스. 1번 프로세스가 새 부모 프로세스가 되어 작업 종료를 지원한다.  
- 좀비 프로세스: 자식 프로세스가 종료했는데도 남아있는 부모 프로세스. defunct 프로세스라고 나오기도 한다. idle status라고도 한다.  

좀비 프로세스가 증가하면 프로세스 테이블 용량이 부족해져서 일반 프로세스가 실행되지 않을 수 있다.

<br/>

## 프로세스 관리 명령
### 프로세스 정보 출력
- ps -f: 프로세스의 상세 정보 출력. PPID, 시작 시간, CPU 사용량 등 표시한다.  
- ps -e: 시스템에서 실행 중인 모든 프로세스 출력. f 옵션과 합쳐서 자주 사용된다.

### 프로세스 종료
- kill -9 프로세스id: 프로세스id에 해당하는 프로세스를 강제로 종료한다.
- killall 프로세스명: 프로세스명을 가진 모든 프로세스를 종료한다.

시그널에 관한 정보는 kill -l하면 볼 수 있다.  
15) SIGTERM은 정상 종료  
9) SIGKILL은 비정상 종료

kill -9는 kill -SIGKILL과 같다.

### 프로세스 관리 도구
- top: 현재 실행 중인 프로세스에 대한 정보를 주기적으로 출력. 비슷한 모니터링 tool로 htop이 있다.

<br/>

## 작업 예약
### 정해진 시간에 반복 실행
crontab  
crontab 파일 형식(분(0 ~ 59) 시(0 ~ 23) 일(1 ~ 31) 월(1 ~ 12) 요일(0 ~ 6) 작업 내용)에 맞춰 작성하면 해당하는 시간에 내용이 실행된다.  
작업 내용 부분에서 실행할 명령어는 무조건 절대경로로 작성한다.  
　ex) ls -> /usr/bin/ls

crontab 편집기는 vi 또는 EDITOR 환경 변수에 지정된 편집기를 사용한다.

### crontab 명령어
- crontab -e: crontab -e으로 편집한 파일 저장 시, /var/spool/cron 디렉터리에 사용자 이름으로 생성(이미 사용자가 만든 파일이 있으면 덮어쓰기)
- crontab -l: crontab 파일 내용 확인

### crontab 명령 사용 제한
/etc/cron.allow, /etc/cron.deny

deny 파일은 기본적으로 있지만 allow 파일은 관리자가 만들어야 한다.  
deny에 특정 사용자가 적혀있으면 그 사용자는 crontab 명령어를 사용할 수 없다.  
allow에 특정 사용자가 적혀있으면 그 사용자는 crontab 명령어를 사용할 수 있다.
