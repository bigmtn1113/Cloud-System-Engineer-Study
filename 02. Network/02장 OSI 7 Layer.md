# OSI 7 Layer

<br/>

## Application Layer
- 응용 프로세스와 직접 관계하여 일반적인 응용 서비스 수행

- 사용자나 응용 프로그램 사이에 데이터의 교환이 가능하게 하는 계층

- 응용 프로세스 간의 정보 교환, 파일전송, VPN 등의 서비스 제공

- 프로토콜: DNS, HTTP, FTP, 터미널 서비스(VPN), SMTP, POP3, IMAP, ...

### FTP
File Transfer Protocol. 파일 전송을 위해 사용되는 프로토콜. 보통 20번, 21번 포트를 사용한다.  
윈도우에선 FileZilla 프로그램 주로 사용

**Active mode vs Passive mode**
- Active mode  
  1\. 클라이언트(n번 포트)는 서버(21번 포트)로 접속한 후에 자신이 사용할 두 번째 포트(n + 1)를 서버에 알려준다.

  2\. 서버(21번 포트)는 클라이언트(n번 포트)로 요청에 응답한다.
  
  3\. 서버(20번 포트)는 클라이언트가 알려준 두 번째 포트(n + 1)로의 접속을 시도한다.
  
  4\. 클라이언트(n + 1)는 서버(20번 포트)로 요청에 응답한다.

  특징
  - 클라이언트에서 외부 접근을 막아둔다면 ftp 접속이 정상적으로 이뤄지지 않는다.
  
  - 서버 측은 OUTBOUND(내부 -> 외부), 클라이언트 측은 INBOUND(외부 -> 내부) 설정을 해줘야 한다.

- Passive mode  
  1\. 클라이언트(n번 포트)가 서버(21번 포트)로 Passive mode 연결 접속을 시도한다.
  
  2\. 서버(21번 포트)는 사용할 두 번째 포트를 클라이언트(n번 포트)에게 알려준다.
  
  3\. 클라이언트는 다른 포트(n + 1번 포트)를 열어 서버가 알려준 포트로 접속을 시도한다.
  
  4\. 서버(서버가 알려준 포트)가 클라이언트(n + 1)의 요청에 응답한다.

  특징
  - 20번 포트를 사용하지 않고 1024번 ~ 65535번 중 임의의 포트를 사용한다.
  
  - 서버가 임의의 포트를 사용함에 따라 클라이언트도 INBOUND 설정을 모두 해줘야 한다.
  
  - Passive 포트 범위 설정을 해주면 어느정도 문제 해결이 가능하다.

<br/>

## Presentation Layer
- 응용 계층으로부터 받은 데이터를 하위 계층인 세션 계층에 보내기 전에 통신에 적당한 형태로 변환하고 세션 계층에서 받은 데이터는 응용 계층에 맞게 변환하는 역할 수행. 코드 간의 번역 담당

- 코드 변환, 구문 검색, 데이터 압축 및 암호화 등의 기능 담당

- 프로토콜: JPG, MPEG, ...

<br/>

## Session Layer
- 양 끝 단의 응용 프로세스가 통신을 관리하기 위한 방법을 제공

- 통신 세션을 구성하며 포트 번호를 기반으로 연결

- 전송 계층이 종단간에 논리적인 설정을 담당한다면 세션 계층은 이런 연결에 정보 교환을 효과적으로 할 수 있게 추가 서비스 진행

- 프로토콜: NetBIOS, SSH, TLS, ...

<br/>

## Transport Layer
- 시스템에 도착한 후, Packet이 찾아갈 응용 프로그램과 통하는 통로 번호인 port와 연관

- 패킷의 전송이 유효한지 확인하고 전송에 실패된 패킷을 다시 보내는 것과 같은 신뢰성 있는 통신 보장

- 주소 설정, 오류 및 흐름 제어 등을 수행

- 전송단위: Segment

- 프로토콜: TCP, UDP, ...

- 장비: Gateway, L4 Switch

### 4계층 기준 Packet 구조
5계층까지의 패킷 정보 | 출발지 포트 | 목적지 포트 | 출발지 IP | 목적지 IP | 출발지 MAC | 목적지 MAC

### 주요 Port와 Service
포트 번호 | 서비스
:---: | :---:
20 | FTP
21 | FTP
23 | Telnet
25 | SMTP
53 | DNS
80 | HTTP
110 | POP3
143 | IMAP
